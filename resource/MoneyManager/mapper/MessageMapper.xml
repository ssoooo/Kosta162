<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="GeneralAffairs.store.mapper.MessageMapper">

	<insert id="registMessage" parameterType="Message">
		INSERT INTO
		message_table(messsageId,eventId,sendMemberId,title,content,regDate)
		VALUES(message_seq.nextval,#{eventId},#{memberId},#{title},#{content},SYSDATE)
	</insert>

	<delete id="deleteMessage" parameterType="int">
		DELETE FROM message_table
		WHERE messageId=#{messageId}
	</delete>

	<select id="retrieveMessageById" parameterType="int" resultType="Message">
		SELECT messageId,eventId,sendMemberId,title,content,regDate
		FROM message_table
		WHERE messageId=#{messageId}
	</select>

	<insert id="registMessageWithMember" parameterType="map">
		INSERT INTO
		messageMember_table(memberId,messageId)
		VALUES(#{memberId},#{messageId})
	</insert>

	<delete id="deleteMessageWithMember" parameterType="map">
		DELETE FROM messageMember_table
		WHERE memberId=#{memberId} AND messageId=#{messageId}
	</delete>

	<select id="retrieveAllMyMessages" parameterType="String" resultType="Message">
		SELECT a.messageId, a.sendmemberId, a.title, a.content, a.regdate
		FROM message_table a, messageMember_table b
		WHERE a.messageId = b.messageId and b.memberId=#{memberId}
	</select>

</mapper>